# api_autoria_search_bot

Экспериментальный Telegram-бот на nodejs, для демострации возможностей API поиска AUTORIA

# Как установить

Для запусчка своей версии бота вам потребуется сервер с установленным [nodejs](https://nodejs.org/en/) >= v.7.6, доступ в интернет и установленный на мобильном месенджер [telegram](https://telegram.org/)

### Регистрация бота в месенджере telegram

Руководство на русском о том [как создать telegram-бота](http://www.mybot.pro/single-post/2016/09/04/%D0%9A%D0%B0%D0%BA-%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C-%D0%B1%D0%BE%D1%82%D0%B0-%D0%B2-Telegram-BotFather-%D0%BF%D0%BE-%D1%80%D1%83%D1%81%D1%81%D0%BA%D0%B8) 

### Клонирование проекта

Убедитесь что у Вас установлен git для того чтоб можно было получить последнюю версию проекта с github. Далее переходим в папку, в которой будет создан проект и даем следующие команды
```bash
git clone https://github.com/ria-com/api_autoria_search_bot.git
rm -rf ./.git
mv api_autoria_search_bot myBot
```
где **myBot** это новое название вашего бота. 

### Установка дополнительных модулей
 
Переходщим в папку с проектом и инсталируем нужные модули 
```bash
cd myBot
npm install
```

### Конфигурирование бота
Все дополнительные настройки будем определять в файле **./config/default.json**

Нам нужно вместо фразы **place_your_api_key_here** вписать ключ, который вы получили при регистрации на портале [developers.ria.com](https://developers.ria.com),  он выглядит как-то так **or25fykeGB385ebd0AL3456nT34lLlypR12bBIc**.

Далее вместо фразы **place_your_token_here** впишем токен, который мы получили при регистрации telegram-бота


### Запуск бота

Для работы бота необходимо чтоб пользователь от которого будет запускаться бот имел права на запись в директорию ./data

Запускаем 
```bash
node ./app.js
```

### Модернизация кода

Процесс рассылки ботом новых передложений находиться в конце ./app.js, 
```javascript
var j = schedule.scheduleJob('53 * * * *', function(){
// ...
});
```
где '53 * * * *' это настройка когда роботу осуществлять поиск новых предложений, в данном случае установлено что проверка запускаеться каждую 53-ю минуту каждого часа.

В этой части кода вы может сделать код значительно интелектуальнее, после того как вы получаете id объявлений которые подошли под условия поиска можно получить информацию по каждому объявлению (по его id) и провести дополнительные более сложные проверки. 